<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../bower_components/paper-toolbar/paper-toolbar.html">
<dom-module id="xl-schedule">
  <template>

  <style>
          h1 {
        text-align: center;
        font-weight: 400;
        font-size: 34px;
      }

      @media( min-width: 980px) {
        h1 {
          font-size: 56px;
        }
      }

      paper-tabs {
        background-color: #00BCD4;
        color: white;
      }

      .container {
        width: 100%;
        max-width: 980px;
        margin: auto;
      }

  </style>

    <h1> Excel Schedule </h1>

    <div class="container">
      <paper-tabs selected="0">
        <paper-tab>All Days</paper-tab>
        <paper-tab>Day 1</paper-tab>
        <paper-tab>Day 2</paper-tab>
        <paper-tab>Day 3</paper-tab>
        <paper-tab>Day 4</paper-tab>
      </paper-tabs>
      <div>


        <paper-toolbar>
        <div>Filter :</div>  
          <select autofocus value="{{department::input}}" on-change="refreshFilter">
            <option value="all" selected>All Departments</option>
            <option value="cs">Computer Science</option>
            <option value="ec">Electronics and Communication</option>
          </select>
          &nbspEvents :
            <input type="checkbox" value="online"  checked id="onlineBox" on-change="refreshFilter"> <div>Online Events</div>
            <input type="checkbox" value="offline" checked id="offlineBox" on-change="refreshFilter"><div>Offline Events</div>
        </paper-toolbar>

          </div>
      <template id="scheduleList" is="dom-repeat" items="{{schedule}}" filter="computeFilter">
          <div># <span>{{index}}</span></div>
          <div>Event name: <span>{{item.name}}</span></div>
          <div>Date: <span>{{item.date}}</span></div>
      </template>      
    </div>
  </template>

  <script>

    Polymer({
      is: 'xl-schedule',
      ready: function() {

              var _thisPage = this;

              fetch('resources/schedule.json').
              then(function (response) {
                  return response.json();
              }).
              then(function (response) {
                _thisPage.schedule = response;
              })
              .catch(function(err) {
                console.log("err",err);
              });

     },
     computeFilter: function(item){
              var _self = this;
              var _department = _self.department;
              var _scheduleItem = item;

              //Check if online and offline checkboxes are ticked
              var onlineState = (_self.$.onlineBox.checked) ? "online" : "not online";
              var offlineState = (_self.$.offlineBox.checked) ? "offline" : "not offline";

              //if event type (online or offline) does not match either of the checked boxes, return false
              if (!(_scheduleItem.type === onlineState || _scheduleItem.type === offlineState)) {
                return false;
              }

              //if no or all department(s) specified, return true
              if(!_department || _department === 'all'){
                return true;
              }

              // check if department specified is same as data
              return _scheduleItem.department === _department;



     },

     refreshFilter : function () {
        this.$.scheduleList.render();
     }
    });
  </script>

</dom-module>