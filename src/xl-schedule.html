<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../bower_components/paper-dropdown-menu/paper-dropdown-menu-light.html">
<link rel="import" href="../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-header-panel/paper-header-panel.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../bower_components/paper-styles/shadow.html">

<dom-module id="xl-schedule">
  <template>
  <style >
    :host{
      text-align: center;
    }
    .card {
        box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
        margin: 24px;
        background-color: #fff;
        color: #757575;
        padding-top: 16px;
        padding-bottom: :16px;
    }
    .paper-header{
      padding-bottom: 10px;
    }
    paper-card.event>div{
      text-align: center;
      order: 1;
      flex-grow: 1;
    }
    paper-card.event>div:last{
      flex-shrink: 2;
    }

  </style>
  <style is="custom-style" include="iron-flex iron-flex-alignment">
    paper-card.event{
      @apply(--layout-horizontal);
      padding-top: 5px;
      padding-bottom: 5px;
      /*border-top: 1px solid #b3b3b3;*/
      border-bottom: 1px solid #b3b3b3;
    }
  </style>

    <div class="card">
      
        <div style="height:200px;">
            <paper-header-panel mode="standard">
              <div class="paper-header">
              <h1> Excel Schedule </h1>
              <paper-dropdown-menu-light on-click="refreshFilter" label="Filter">
              <paper-listbox class="dropdown-content" attr-for-selected="value" selected="{{selectedFilter}}">
                <paper-item value="all">All Departments</paper-item>
                <paper-item value="cs">Computer Science</paper-item>
                <paper-item value="ec">Electronics and Communication</paper-item>
              </paper-listbox>
            </paper-dropdown-menu-light>



            &nbspEvents :
            <paper-checkbox value="online" id="onlineBox" checked on-click="refreshFilter">Online Events</paper-checkbox>
            <paper-checkbox value="offline" id="offlineBox" checked on-click="refreshFilter">Offline Events</paper-checkbox>
            </div>
        
        </paper-header-panel>
        </div>


        <template id="scheduleList" is="dom-repeat" items="{{schedule}}" filter="computeFilter">
            <paper-card class="event">              
                <div>
                  <h2>{{item.name}}</h2>
                  <div><h4>Venue</h4></div>
                </div>
                <!-- <div># <span>{{index}}</span></div> -->
                <!-- <div>Event name: <span>{{item.name}}</span></div> -->
                <div><h6>{{item.date}}</h6></div>              
            </paper-card>
            <paper-card class="event">              
                <div>
                  <h2>{{item.name}}</h2>
                  <div><h4>Venue</h4></div>
                </div>
                <!-- <div># <span>{{index}}</span></div> -->
                <!-- <div>Event name: <span>{{item.name}}</span></div> -->
                <div><h6>{{item.date}}</h6></div>              
            </paper-card>
        </template>
      </div>
    </div>
  </template>


  <script>;

    Polymer({
      is: 'xl-schedule',
      ready: function() {

              var _thisPage = this;

              fetch('resources/schedule.json').
              then(function (response) {
                  return response.json();
              }).
              then(function (response) {
                _thisPage.schedule = response;
              })
              .catch(function(err) {
                console.log("err",err);
              });
              this.selectedFilter = "all";
     },
     computeFilter: function(item){
              var _self = this;
              var _department = _self.selectedFilter;
              var _scheduleItem = item;
              //Check if online and offline checkboxes are ticked
              var onlineState = (_self.$.onlineBox.checked) ? "online" : "not online";
              var offlineState = (_self.$.offlineBox.checked) ? "offline" : "not offline";
              //if event type (online or offline) does not match either of the checked boxes, return false
              if (!(_scheduleItem.type === onlineState || _scheduleItem.type === offlineState)) {
                return false;
              }

              //if no or all department(s) specified, return true
              if(!_department || _department === 'all'){
                return true;
              }

              // check if department specified is same as data
              return _scheduleItem.department === _department;



     },

     refreshFilter : function () {
        this.$.scheduleList.render();
     }
    });
  </script>

</dom-module>