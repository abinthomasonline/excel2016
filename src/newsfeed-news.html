<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="../bower_components/paper-card/paper-card.html">

<dom-module id="newsfeed-news">
<style>
	:host{
		
	}
	.container{
		
		display: block;
		position: relative;
	}

	.card{
		position: absolute;		
		display: block;
		/*border: 1px solid black;*/
		text-align: center;
		transition: transform 1s;
		transform: translateX(0)translateY(50px);
		box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14),
                  0 1px 5px 0 rgba(0, 0, 0, 0.12),
                  0 3px 1px -2px rgba(0, 0, 0, 0.2);
	}
	.animate{
		transform: translateX(0)translateY(0);
	}
	@media (max-width: 800px){
		.card{
			
		}
	}
	.card-contents{
		display: block;
		width: 100%;
		
		background-color: white;
	}
	.card-contents img{
		width: inherit;
	}
</style>
<template>
	<div class="container" id="container">
		<!-- <div class="card">
			<div class="card-contents">
				<img src="../images/icons/Soccer.png" >
				<h2>Heading</h2>
				<p>This is some content asfabkjsfb	This is some content asjfabkjsfb1</p>
			</div>
		</div>
		<div class="card">
			<div class="card-contents">
				<img src="../images/icons/Soccer.png" >
				<p>This is some content asjfabkjsfb	This is2</p>
			</div>
		</div>
		<div class="card">
			<p>This is some content asjfabkjsfb	This is3</p>
		</div>
		<div class="card">
			<div class="card-contents">
				<p>This is some content asjfabkjsfb	This is4</p>
			</div>
		</div>
		<div class="card">
			<div class="card-contents">
				<p>This is some content asjfabkjsfb	This isThis is some content 5</p>
			</div>
		</div>
		<div class="card">
			<div class="card-contents">
				<p>This is some content asjfabkjsfb	This isThis is some content asjfabkjsfb6</p>
			</div>
		</div>
		<div class="card">
			<div class="card-contents">
				<p>This is some content asjfabkjsfb	This isThis is some content asjfabkjsfb7</p>
			</div>
		</div>
		<div class="card">
			<div class="card-contents">
				<p>This is some content asjfabkjsfb	This is8</p>
			</div>
		</div>
		<div class="card">
			<div class="card-contents">
				<p>This is some content asjfabkjsfb	This isThis is some content asjfabkjsfb9</p>
			</div>
		</div>
		<div class="card">
			<div class="card-contents">
				<p>This is some content asjfabkjsfb	This isThis is some content asjfabkjsfb10</p>
			</div>
		</div>
		<div class="card">
			<div class="card-contents">
				<p>This is some content asjfabkjsfb	This isThis is some content asjfabkjsfb11</p>
			</div>
		</div>  -->
	</div>
</template>
<script>
	Polymer({
		is:'newsfeed-news',
		ready: function(){
			var self = this;
			var jsonResp;
	        fetch('resources/feed.json').
	        then(function (response) {	        	
	            return response.json();
	        }).
	        then(function (response){
	        	// alert(response[0].title);
	        	self.renderFeeds(self,response);
	        	self.initPos();
	        })
	        .catch(function(err) {
	          console.log("err",err);
	        });
	        // alert(jsonResp);
			
		},
		initPos: function(){
			var children = this.$.container.children,contains,cardWidth;
			var screenWidth = window.innerWidth;
			var rowHeights = Array();
			if(screenWidth>=980){
				contains = 3;
				cardWidth = (Math.round(950/contains));
				container = 980;
				left = (screenWidth-980)/2;
			}
			else if(screenWidth>600){
				contains = 2;
				cardWidth = (Math.round((screenWidth-20)/contains));
				container = screenWidth;
				left = 0;
			}
			else{
				contains = 1;
				cardWidth = (Math.round((screenWidth-10)/contains));
				container = screenWidth;
				left = Math.round((screenWidth-10-cardWidth)/2);
			}
			var child;
			var position;
			var minHeight,j;
			for(i=0;i<children.length;++i){
				child = children[i];
				child.style.width = cardWidth+"px";
				if(i>contains-1){
					minHeight = rowHeights[0];
					j=1;
					position = 0;
					while(j<contains){
						if(rowHeights[j]<minHeight){
							minHeight = rowHeights[j];
							position = j;
						}
						j++;
					}
					child.style.left = left+5+((position)*cardWidth)+(position*10)+"px";
					child.style.top = minHeight + 10 + "px";
					rowHeights[position] = rowHeights[position]+child.offsetHeight+10;
				}
				else{
					child.style.left = left+5+((i%contains)*cardWidth)+(i%contains*10)+"px";
					rowHeights[i] = child.offsetHeight;
				}
				children[i].classList.add('animate');
			}
		},
		renderFeeds: function(self,response){
			var i;
			for(i=0;i<response.length;i++){
				var div = document.createElement('DIV');
	        	var htmlContent = "<div class=\"card-contents\"><img src="+response[i].image+"><h2>"+response[i].title+"</h2><p>"+response[i].description+"</p></div>";
	        	div.innerHTML = htmlContent;
	        	div.classList.add('card');
	        	self.$.container.appendChild(div);
			}
		}
	});
</script>
</dom-module>